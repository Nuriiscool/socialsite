<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Nuri's social media links and real-time status">
  <meta property="og:image" content="https://nuriiscool.github.io/testing/kokushibo.png">
  <title>Nuri | Social Links</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    }
    #particles-js {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 0;
    }
    .content {
      position: relative;
      z-index: 1;
      text-align: center;
      max-width: 500px;
      width: 100%;
      animation: fadeIn 1.2s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .avatar {
      width: 140px;
      height: 140px;
      max-width: 100%;
      border-radius: 50%;
      border: 4px solid white;
      object-fit: cover;
      margin-bottom: 15px;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
    }
    .status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 15px;
      padding: 4px 12px;
      border-radius: 20px;
      background: rgba(0, 0, 0, 0.3);
      font-size: 14px;
    }
    .status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }
    .online { background: #2ecc71; }
    .offline { background: #95a5a6; }
    .unknown { background: #bdc3c7; }
    .status-message {
      max-width: 300px;
      margin: 0 auto 20px;
      padding: 8px 12px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      font-size: 14px;
    }
    #admin-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 100;
      justify-content: center;
      align-items: center;
    }
    #admin-panel {
      background: rgba(0, 0, 0, 0.9);
      padding: 25px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }
    #admin-login {
      display: block;
    }
    #admin-controls {
      display: none;
    }
    input, select, button {
      padding: 10px;
      border-radius: 5px;
      border: none;
      margin: 8px 0;
      width: 100%;
    }
    button {
      background: #3498db;
      color: white;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover {
      opacity: 0.9;
    }
    button:disabled {
      background: #7f8c8d;
      cursor: not-allowed;
    }
    .link-button {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 260px;
      margin: 10px auto;
      padding: 14px;
      color: white;
      text-decoration: none;
      font-weight: 600;
      border-radius: 30px;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    .link-button:hover {
      transform: translateY(-3px);
    }
    .instagram { background: linear-gradient(45deg, #f09433, #e6683c, #dc2743); }
    .tiktok { background: linear-gradient(45deg, #010101, #25f4ee, #fe2c55); }
    .youtube { background: linear-gradient(45deg, #ff0000, #ff0000cc); }
    .discord { background: linear-gradient(45deg, #5865f2, #5865f2cc); }
    .telegram { background: linear-gradient(45deg, #0088cc, #0088cccc); }
    .twogis { background: linear-gradient(45deg, #33a6ff, #0077cc); }
    .copy-btn {
      margin-top: 15px;
      background: linear-gradient(45deg, #00c9ff, #92fe9d);
      padding: 12px 20px;
      border: none;
      border-radius: 25px;
      color: white;
      cursor: pointer;
    }
    .loading-spinner {
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    @media (max-width: 500px) {
      .link-button { 
        width: 100%;
        padding: 12px 14px;
        font-size: 14px;
      }
    }
    @media (max-width: 360px) {
      .avatar {
        width: 120px;
        height: 120px;
      }
    }
  </style>
</head>
<body>
  <!-- Animated background (only for desktop) -->
  <div id="particles-js"></div>

  <!-- Main content -->
  <div class="content">
    <img src="kokushibo.png" class="avatar" alt="Nuri">
    <h2>Nuri</h2>
    
    <!-- Status system -->
    <div class="status" id="status-container">
      <div class="status-dot unknown" id="status-dot"></div>
      <span id="status-text">Loading...</span>
    </div>
    <div class="status-message" id="status-message">
      Connecting to status service...
    </div>

    <h1>Hello! ðŸ‘‹</h1>
    <p>Connect with me:</p>

    <a class="link-button instagram" href="https://instagram.com/nxr1_ba" target="_blank">
      <i class="fab fa-instagram"></i> Instagram
    </a>
    <a class="link-button tiktok" href="https://tiktok.com/@nxr1_ba" target="_blank">
      <i class="fab fa-tiktok"></i> TikTok
    </a>
    <a class="link-button youtube" href="https://youtube.com/@Nuriiscool" target="_blank">
      <i class="fab fa-youtube"></i> YouTube
    </a>
    <a class="link-button discord" href="https://discord.gg/R2D36VqGKA" target="_blank">
      <i class="fab fa-discord"></i> Discord Server
    </a>
    <a class="link-button telegram" href="https://t.me/darrliquer" target="_blank">
      <i class="fab fa-telegram"></i> Telegram
    </a>
    <a class="link-button twogis" href="https://2gis.ru/user/0b76b22dcf9741b381e78401e82270d0" target="_blank">
      <i class="fas fa-map-marked-alt"></i> 2GIS
    </a>

    <button class="copy-btn" onclick="copyTelegram()">
      <i class="fas fa-copy"></i> Copy Telegram
    </button>
  </div>

  <!-- Admin Overlay -->
  <div id="admin-overlay">
    <div id="admin-panel">
      <div id="admin-login">
        <h3>Admin Access</h3>
        <input type="password" id="admin-password" placeholder="Enter password">
        <button onclick="checkAdminPassword()">Continue</button>
        <button onclick="hideAdminPanel()" style="background: #e74c3c; margin-top: 10px;">Cancel</button>
      </div>
      <div id="admin-controls">
        <h3>Status Manager</h3>
        <select id="status-select">
          <option value="offline">Offline</option>
          <option value="online">Online</option>
        </select>
        <input type="text" id="status-custom-text" placeholder="What I'm doing...">
        <button id="update-btn" onclick="updateStatus()">Update Status</button>
        <div id="status-update-message" style="margin-top: 10px; font-size: 14px;"></div>
        <button onclick="hideAdminPanel()" style="background: #e74c3c; margin-top: 10px;">Close Panel</button>
      </div>
    </div>
  </div>

  <!-- Particles.js -->
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <script>
    // ======================
    // ENHANCED FIREBASE SETUP
    // ======================
    const firebaseConfig = {
      apiKey: "AIzaSyBwjcK9brfOAwlkojOfYgMO_dFY-DNvEvQ",
      authDomain: "nuri-test-95cc5.firebaseapp.com",
      databaseURL: "https://nuri-test-95cc5-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "nuri-test-95cc5",
      storageBucket: "nuri-test-95cc5.firebasestorage.app",
      messagingSenderId: "440508513511",
      appId: "1:440508513511:web:f85ed92675fd040aad3642"
    };

    // Initialize Firebase with error handling
    try {
      firebase.initializeApp(firebaseConfig);
      console.log("Firebase initialized successfully");
    } catch (error) {
      console.error("Firebase initialization error:", error);
      document.getElementById('status-text').textContent = "Connection Error";
      document.getElementById('status-message').textContent = "Failed to connect to status service";
    }

    const database = firebase.database();
    const auth = firebase.auth();

    // ======================
    // SECURE ADMIN PANEL
    // ======================
    const ADMIN_PASSWORD = "nuri123"; // Change this in production!
    let lastUpdateTime = 0;
    const UPDATE_COOLDOWN = 5000; // 5 seconds

    function showAdminPanel() {
      document.getElementById('admin-overlay').style.display = 'flex';
      document.getElementById('admin-login').style.display = 'block';
      document.getElementById('admin-controls').style.display = 'none';
    }
    
    function hideAdminPanel() {
      document.getElementById('admin-overlay').style.display = 'none';
    }
    
    function checkAdminPassword() {
      const password = document.getElementById('admin-password').value;
      if (password === ADMIN_PASSWORD) {
        document.getElementById('admin-login').style.display = 'none';
        document.getElementById('admin-controls').style.display = 'block';
        document.getElementById('admin-password').value = '';
        
        // Load current status into form
        database.ref('status').once('value').then((snapshot) => {
          const data = snapshot.val() || {};
          document.getElementById('status-select').value = data.state || 'offline';
          document.getElementById('status-custom-text').value = data.message || '';
        });
      } else {
        alert("Incorrect password!");
      }
    }

    // Triple click detection (bottom right corner)
    let clickCount = 0;
    document.addEventListener('click', (e) => {
      if (e.clientX > window.innerWidth - 100 && e.clientY > window.innerHeight - 100) {
        clickCount++;
        if (clickCount >= 3) {
          showAdminPanel();
          clickCount = 0;
        }
        setTimeout(() => { clickCount = 0; }, 1000);
      }
    });

    // ======================
    // ENHANCED STATUS SYSTEM
    // ======================
    function updateStatus() {
      const now = Date.now();
      if (now - lastUpdateTime < UPDATE_COOLDOWN) {
        const remaining = Math.ceil((UPDATE_COOLDOWN - (now - lastUpdateTime)) / 1000;
        document.getElementById('status-update-message').textContent = 
          `Please wait ${remaining}s before next update`;
        return;
      }

      const status = document.getElementById('status-select').value;
      const text = document.getElementById('status-custom-text').value;
      const btn = document.getElementById('update-btn');
      
      btn.disabled = true;
      btn.innerHTML = '<i class="fas fa-spinner loading-spinner"></i> Updating...';
      document.getElementById('status-update-message').textContent = '';
      
      // Save to Firebase with timestamp
      database.ref('status').set({
        state: status,
        message: text || "Status not set yet",
        updatedAt: firebase.database.ServerValue.TIMESTAMP
      }).then(() => {
        lastUpdateTime = Date.now();
        btn.innerHTML = 'âœ“ Updated!';
        document.getElementById('status-update-message').textContent = 
          'Status updated for all users';
        setTimeout(() => {
          btn.innerHTML = 'Update Status';
          btn.disabled = false;
        }, 2000);
      }).catch((error) => {
        console.error("Update error:", error);
        btn.innerHTML = 'âœ– Error';
        document.getElementById('status-update-message').textContent = 
          'Failed to update: ' + error.message;
        setTimeout(() => {
          btn.innerHTML = 'Update Status';
          btn.disabled = false;
        }, 3000);
      });
    }

    // Listen for status changes with fallback
    function setupStatusListener() {
      database.ref('status').on('value', (snapshot) => {
        const data = snapshot.val() || {};
        console.log("Status update received:", data);
        
        const status = data.state || 'unknown';
        const message = data.message || 'Status not available';
        
        document.getElementById('status-dot').className = 'status-dot ' + status;
        document.getElementById('status-text').textContent = 
          status === 'online' ? 'Online' : 
          status === 'offline' ? 'Offline' : 'Unknown';
        document.getElementById('status-message').textContent = message;
        
        // Cache last status
        localStorage.setItem('lastStatus', JSON.stringify(data));
      }, (error) => {
        console.error("Listener error:", error);
        // Fallback to cached status
        const cached = JSON.parse(localStorage.getItem('lastStatus')) || {};
        document.getElementById('status-dot').className = 'status-dot unknown';
        document.getElementById('status-text').textContent = 'Connection Error';
        document.getElementById('status-message').textContent = 
          cached.message || 'Using cached status';
      });
    }

    // Initialize with cached data while connecting
    const cachedStatus = JSON.parse(localStorage.getItem('lastStatus')) || {};
    document.getElementById('status-dot').className = 'status-dot ' + (cachedStatus.state || 'unknown');
    document.getElementById('status-text').textContent = 
      cachedStatus.state === 'online' ? 'Online' : 
      cachedStatus.state === 'offline' ? 'Offline' : 'Connecting...';
    document.getElementById('status-message').textContent = 
      cachedStatus.message || 'Loading status...';

    // Start listening
    setupStatusListener();

    // Connection monitoring
    database.ref('.info/connected').on('value', (snapshot) => {
      if (snapshot.val() === true) {
        console.log("Firebase connected");
      } else {
        console.log("Firebase disconnected");
      }
    });

    // ======================
    // OTHER FUNCTIONS
    // ======================
    function copyTelegram() {
      navigator.clipboard.writeText('@darrliquer')
        .then(() => {
          const btn = document.querySelector('.copy-btn');
          btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
          setTimeout(() => {
            btn.innerHTML = '<i class="fas fa-copy"></i> Copy Telegram';
          }, 2000);
        })
        .catch(() => alert("Failed to copy"));
    }

    // Initialize particles only on desktop
    if (!/Mobi|Android/i.test(navigator.userAgent)) {
      particlesJS("particles-js", {
        "particles": {
          "number": { "value": 60 },
          "size": { "value": 3 },
          "color": { "value": "#ffffff" },
          "opacity": { "value": 0.3 },
          "move": { "speed": 1 },
          "line_linked": {
            "enable": true,
            "distance": 120,
            "color": "#ffffff",
            "opacity": 0.2,
            "width": 1
          }
        },
        "interactivity": {
          "events": {
            "onhover": { "enable": true, "mode": "repulse" }
          }
        }
      });
    }

    // Service worker for offline support
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(registrationError => {
          console.log('SW registration failed: ', registrationError);
        });
      });
    }
  </script>
</body>
</html>